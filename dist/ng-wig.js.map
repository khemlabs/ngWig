{"version":3,"sources":["ng-wig.js"],"names":["VERSION","angular","module","ngWig","version","TABKEY","ENTERKEY","component","bindings","content","options","onPaste","buttons","language","beforeExecCommand","afterExecCommand","placeholder","require","ngModelController","templateUrl","controller","$scope","$element","$q","$attrs","$window","$document","$mdDialog","__env","fileService","ngWigToolbar","addString","ev","str","preventDefault","$ctrl","$el","document","getElementById","start","selectionStart","end","selectionEnd","first","substring","last","selected","indexOf","split","join","setTimeout","focus","keyDown","keyCode","$container","element","querySelector","spanish","required","isSourceModeAllowed","editMode","$observe","disabled","isDisabled","attr","isEditorActive","activeElement","toggleEditMode","getSelection","removeAllRanges","execCommand","command","queryCommandSupported","openDialogConfirm","confirmed","openDialog","path","type","length","apiDomain","token","fileCommand","prompt","console","log","_execCommand","selection","toString","$onInit","toolbarButtons","getToolbarButtons","string2array","Boolean","$render","$viewValue","html","empty","bind","$setViewValue","$applyAsync","on","pasteContent","window","clipboardData","getData","event","originalEvent","when","$event","then","pasteHtmlAtCaret","pasteText","keysString","map","Function","prototype","call","String","trim","sel","range","getRangeAt","rangeCount","deleteContents","el","createElement","innerHTML","frag","createDocumentFragment","node","lastNode","firstChild","appendChild","insertNode","cloneRange","setStartAfter","collapse","addRange","createRange","pasteHTML","provider","buttonLibrary","list1","title","styleClass","list2","bold","italic","link","defaultButtonsList","isButtonActive","queryCommandState","setButtons","isArray","addStandardButton","name","push","addCustomButton","pluginName","isComplex","$get","list","forEach","buttonKey","Object","keys","button","copy","isActive","plugin","$compile","replaceWith","run","$templateCache","put"],"mappings":"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","file":"ng-wig.js","sourcesContent":["/**\n * version: 3.0.21\n */\nvar VERSION = '3.0.16';\nangular.module('ngWig', ['ngwig-app-templates']);\nangular.ngWig = {\n  version: VERSION\n};\n\nconst TABKEY = 9;\nconst ENTERKEY = 13;\n\nangular.module('ngWig').component('ngWig', {\n\tbindings: {\n\t\tcontent: '=ngModel',\n\t\toptions: '<?',\n\t\tonPaste: '&',\n\t\tbuttons: '@',\n\t\tlanguage: '@',\n\t\tbeforeExecCommand: '&',\n\t\tafterExecCommand: '&',\n\t\tplaceholder: '@?'\n\t},\n\trequire: {\n\t\tngModelController: 'ngModel'\n\t},\n\ttemplateUrl: 'ng-wig/views/ng-wig.html',\n\tcontroller: [\"$scope\", \"$element\", \"$q\", \"$attrs\", \"$window\", \"$document\", \"$mdDialog\", \"__env\", \"fileService\", \"ngWigToolbar\", function($scope, $element, $q, $attrs, $window, $document, $mdDialog, __env, fileService, ngWigToolbar) {\n\t\tthis.addString = (ev, str) => {\n\t\t\tev.preventDefault();\n\t\t\tif (!$scope.$ctrl.content) $scope.$ctrl.content = '';\n\t\t\tlet $el = document.getElementById('nw-editor__src');\n\t\t\tconst start = $el.selectionStart;\n\t\t\tconst end = $el.selectionEnd;\n\t\t\tconst first = $scope.$ctrl.content.substring(0, start);\n\t\t\tconst last = $scope.$ctrl.content.substring(end);\n\t\t\tconst selected = $scope.$ctrl.content.substring(start, end);\n\t\t\tif (str == '\\t' && selected.indexOf('\\n') >= 0) {\n\t\t\t\tstr = `\\t${selected.split('\\n').join('\\n\\t')}`;\n\t\t\t}\n\t\t\tconst content = `${first}${str}${last}`;\n\t\t\t$scope.$ctrl.content = content;\n\t\t\tsetTimeout(() => {\n\t\t\t\t$el.focus();\n\t\t\t\t$el.selectionStart = $el.selectionEnd = start + 1;\n\t\t\t});\n\t\t};\n\n\t\tthis.keyDown = ev => {\n\t\t\tif (ev.keyCode == ENTERKEY) return this.addString(ev, '\\n');\n\t\t\tif (ev.keyCode == TABKEY) return this.addString(ev, '\\t');\n\t\t};\n\n\t\tlet $container = angular.element($element[0].querySelector('#ng-wig-editable'));\n\n\t\tthis.spanish = this.language && this.language == 'spanish';\n\n\t\t//TODO: clean-up this attrs solution\n\t\tthis.required = 'required' in $attrs;\n\t\tthis.isSourceModeAllowed = 'sourceModeAllowed' in $attrs;\n\t\tthis.editMode = false;\n\n\t\t$attrs.$observe('disabled', isDisabled => {\n\t\t\tthis.disabled = isDisabled;\n\t\t\t$container.attr('contenteditable', !isDisabled);\n\t\t});\n\t\tthis.isEditorActive = () => $container[0] === $document[0].activeElement;\n\t\tthis.toggleEditMode = () => {\n\t\t\tthis.editMode = !this.editMode;\n\t\t\tif ($window.getSelection().removeAllRanges) {\n\t\t\t\t$window.getSelection().removeAllRanges();\n\t\t\t}\n\t\t};\n\n\t\tthis.execCommand = (command, options) => {\n\t\t\tif (this.editMode) return false;\n\n\t\t\tif (\n\t\t\t\tcommand !== 'insertVideo' &&\n\t\t\t\t$document[0].queryCommandSupported &&\n\t\t\t\t!$document[0].queryCommandSupported(command)\n\t\t\t) {\n\t\t\t\tthrow `The command \"${command}\" is not supported`;\n\t\t\t}\n\n\t\t\tif (command == 'insertImage') {\n\t\t\t\tfileService.openDialogConfirm(\n\t\t\t\t\tnull,\n\t\t\t\t\t$mdDialog,\n\t\t\t\t\tthis.spanish ? 'Confirmar' : 'Confirm',\n\t\t\t\t\tthis.spanish\n\t\t\t\t\t\t? '¿Desea utilizar el servicio de imágenes de Khemlabs?'\n\t\t\t\t\t\t: 'Do you want to use the Khemlabs image service?',\n\t\t\t\t\t'',\n\t\t\t\t\tthis.spanish ? 'Si' : 'Yes',\n\t\t\t\t\t'No',\n\t\t\t\t\tconfirmed => {\n\t\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\t\tfileService.openDialog(null, $mdDialog, { path: 'files/image', type: 'image' }, token => {\n\t\t\t\t\t\t\t\tif ($container.length) $container[0].focus();\n\t\t\t\t\t\t\t\tthis.beforeExecCommand({ command, options });\n\t\t\t\t\t\t\t\toptions = `${__env.apiDomain}files/image/${token}`;\n\t\t\t\t\t\t\t\t$document[0].execCommand('insertHtml', false, `<img src=\"${options}\"/>`);\n\t\t\t\t\t\t\t\tthis.afterExecCommand({ command, options });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn this.fileCommand(command, options);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (command == 'insertVideo') {\n\t\t\t\tfileService.openDialogConfirm(\n\t\t\t\t\tnull,\n\t\t\t\t\t$mdDialog,\n\t\t\t\t\tthis.spanish ? 'Confirmar' : 'Confirm',\n\t\t\t\t\tthis.spanish\n\t\t\t\t\t\t? '¿Desea utilizar el servicio de videos de Khemlabs?'\n\t\t\t\t\t\t: 'Do you want to use the Khemlabs video service?',\n\t\t\t\t\t'',\n\t\t\t\t\tthis.spanish ? 'Si' : 'Yes',\n\t\t\t\t\t'No',\n\t\t\t\t\tconfirmed => {\n\t\t\t\t\t\tif (confirmed) {\n\t\t\t\t\t\t\tfileService.openDialog(null, $mdDialog, { path: 'files/video', type: 'video' }, token => {\n\t\t\t\t\t\t\t\tif ($container.length) $container[0].focus();\n\t\t\t\t\t\t\t\tthis.beforeExecCommand({ command: command, options: options });\n\t\t\t\t\t\t\t\toptions = `${__env.apiDomain}files/video/${token}`;\n\t\t\t\t\t\t\t\t$document[0].execCommand(\n\t\t\t\t\t\t\t\t\t'insertHtml',\n\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t`<br><br>\n\t\t\t\t\t\t\t\t\t<video style=\"width: 560px; height: 315px\" src=\"${options}\"></video><br><br>\n\t\t\t\t\t\t\t\t\t\t`\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tthis.afterExecCommand({ command: command, options: options });\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toptions = $window.prompt(\n\t\t\t\t\t\t\tthis.spanish\n\t\t\t\t\t\t\t\t? 'Por favor ingrese el ID del video de youtube'\n\t\t\t\t\t\t\t\t: 'Please enter the ID of the youtube video',\n\t\t\t\t\t\t\t''\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (!options) return;\n\t\t\t\t\t\tconsole.log(options);\n\t\t\t\t\t\t$document[0].execCommand(\n\t\t\t\t\t\t\t'insertHtml',\n\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t`<br><br>\n\t\t\t\t\t\t\t\t<iframe style=\"width: 560px; height: 315px\" src=\"https://www.youtube.com/embed/${options}\" frameborder=\"0\" encrypted-media\" allowfullscreen=\"\"></iframe><br><br>\n\t\t\t\t\t\t\t\t\t\t`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tthis.afterExecCommand({ command, options });\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (command === 'createlink') return this.fileCommand(command, options);\n\n\t\t\tthis._execCommand(command, options);\n\t\t};\n\n\t\tthis.fileCommand = (command, options) => {\n\t\t\toptions = $window.prompt(this.spanish ? 'Por favor ingrese la URL' : 'Please enter the URL', 'http://');\n\t\t\tif (!options) return;\n\t\t\tthis._execCommand(command, options);\n\t\t};\n\n\t\tthis._execCommand = (command, options) => {\n\t\t\tthis.beforeExecCommand({ command, options });\n\n\t\t\t// use insertHtml for `createlink` command to account for IE/Edge purposes, in case there is no selection\n\t\t\tconst selection = $document[0].getSelection().toString();\n\t\t\tif (command === 'createlink' && selection === '') {\n\t\t\t\t$document[0].execCommand('insertHtml', false, `<a href=\"${options}\">${options}</a>`);\n\t\t\t} else {\n\t\t\t\t$document[0].execCommand(command, false, options);\n\t\t\t}\n\n\t\t\tthis.afterExecCommand({ command: command, options: options });\n\n\t\t\t// added temporarily to pass the tests. For some reason $container[0] is undefined during testing.\n\t\t\tif ($container.length) $container[0].focus();\n\t\t};\n\n\t\tthis.$onInit = () => {\n\t\t\tthis.toolbarButtons = ngWigToolbar.getToolbarButtons(this.buttons && string2array(this.buttons));\n\n\t\t\tlet placeholder = Boolean(this.placeholder);\n\n\t\t\tthis.ngModelController.$render = () =>\n\t\t\t\tthis.ngModelController.$viewValue\n\t\t\t\t\t? $container.html(this.ngModelController.$viewValue)\n\t\t\t\t\t: placeholder\n\t\t\t\t\t\t? $container.empty()\n\t\t\t\t\t\t: $container.html();\n\n\t\t\t$container.bind('blur keyup change focus click', () => {\n\t\t\t\t//view --> model\n\t\t\t\tif (placeholder && (!$container.html().length || $container.html() === '<br>')) $container.empty();\n\t\t\t\tthis.ngModelController.$setViewValue($container.html());\n\t\t\t\t$scope.$applyAsync();\n\t\t\t});\n\t\t};\n\n\t\t$container.on('paste', event => {\n\t\t\tif (!$attrs.onPaste) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlet pasteContent;\n\t\t\tif (window.clipboardData && window.clipboardData.getData) {\n\t\t\t\t// IE\n\t\t\t\tpasteContent = window.clipboardData.getData('Text');\n\t\t\t} else {\n\t\t\t\tpasteContent = (event.originalEvent || event).clipboardData.getData('text/plain');\n\t\t\t}\n\t\t\tevent.preventDefault();\n\t\t\t$q.when(this.onPaste({ $event: event, pasteContent })).then(pasteText => {\n\t\t\t\tpasteHtmlAtCaret(pasteText);\n\t\t\t});\n\t\t});\n\t}]\n});\n\n//TODO: check the function\nfunction string2array(keysString) {\n\treturn keysString.split(',').map(Function.prototype.call, String.prototype.trim);\n}\n\n//TODO: put contenteditable helper into service\nfunction pasteHtmlAtCaret(html) {\n\tlet sel, range;\n\tif (window.getSelection) {\n\t\tsel = window.getSelection();\n\t\tif (sel.getRangeAt && sel.rangeCount) {\n\t\t\trange = sel.getRangeAt(0);\n\t\t\trange.deleteContents();\n\n\t\t\t// Range.createContextualFragment() would be useful here but is\n\t\t\t// non-standard and not supported in all browsers (IE9, for one)\n\t\t\tlet el = document.createElement('div');\n\t\t\tel.innerHTML = html;\n\t\t\tlet frag = document.createDocumentFragment(),\n\t\t\t\tnode,\n\t\t\t\tlastNode;\n\t\t\twhile ((node = el.firstChild)) {\n\t\t\t\tlastNode = frag.appendChild(node);\n\t\t\t}\n\t\t\trange.insertNode(frag);\n\n\t\t\t// Preserve the selection\n\t\t\tif (lastNode) {\n\t\t\t\trange = range.cloneRange();\n\t\t\t\trange.setStartAfter(lastNode);\n\t\t\t\trange.collapse(true);\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t}\n\t\t}\n\t} else if (document.selection && document.selection.type != 'Control') {\n\t\t// IE < 9\n\t\tdocument.selection.createRange().pasteHTML(html);\n\t}\n}\n\nangular.module('ngWig').provider('ngWigToolbar', function () {\n\n  var buttonLibrary = {\n    list1: {title: 'Unordered List', command: 'insertunorderedlist', styleClass: 'list-ul'},\n    list2: {title: 'Ordered List', command: 'insertorderedlist', styleClass: 'list-ol'},\n    bold: {title: 'Bold', command: 'bold', styleClass: 'bold'},\n    italic: {title: 'Italic', command: 'italic', styleClass: 'italic'},\n    link: {title: 'Link', command: 'createlink', styleClass: 'link'}\n  };\n\n  var defaultButtonsList = ['list1', 'list2', 'bold', 'italic', 'link'];\n\n  var isButtonActive = function () {\n    return !!this.command && document.queryCommandState(this.command);\n  };\n\n  this.setButtons = function(buttons) {\n    if(!angular.isArray(buttons)) {\n      throw 'Argument \"buttons\" should be an array';\n    }\n\n    defaultButtonsList = buttons;\n  };\n\n  this.addStandardButton = function (name, title, command, styleClass) {\n    if(!name || !title || !command) {\n      throw 'Arguments \"name\", \"title\" and \"command\" are required';\n    }\n\n    styleClass = styleClass || '';\n    buttonLibrary[name] = {title: title, command: command, styleClass: styleClass}\n    defaultButtonsList.push(name);\n  };\n\n  this.addCustomButton = function (name, pluginName) {\n    if(!name || !pluginName) {\n      throw 'Arguments \"name\" and \"pluginName\" are required';\n    }\n\n    buttonLibrary[name] = {pluginName: pluginName, isComplex: true};\n    defaultButtonsList.push(name);\n  };\n\n  this.$get = function () {\n    return {\n      getToolbarButtons: function(list) {\n        var toolbarButtons = [];\n        (list || defaultButtonsList).forEach(function(buttonKey) {\n          if(!buttonLibrary[buttonKey]) {\n            throw 'There is no \"' + buttonKey + '\" in your library. Possible variants: ' + Object.keys(buttonLibrary);\n          }\n\n          var button = angular.copy(buttonLibrary[buttonKey]);\n          button.isActive = isButtonActive;\n          toolbarButtons.push(button);\n        });\n        return toolbarButtons;\n      }\n    };\n  };\n\n});\nangular.module('ngWig')\n  .component('ngWigPlugin', {\n    bindings: {\n      plugin: '<',\n      execCommand: '=',\n      editMode: '=',\n      disabled: '=',\n      options: '<',\n      content: '='\n    },\n    controller: [\"$scope\", \"$element\", \"$compile\", function($scope, $element, $compile) {\n      var $ctrl = this;\n      this.$onInit = function() {\n        $element.replaceWith($compile('<' + $ctrl.plugin.pluginName + ' ' +\n        'plugin=' + '\"$ctrl.plugin\"' +\n        'exec-command=' + '\"$ctrl.execCommand\"' +\n        'edit-mode=' + '\"$ctrl.editMode\"' +\n        'disabled=' + '\"$ctrl.disabled\"' +\n        'options=' + '\"$ctrl.options\"' +\n        'content=' + '\"$ctrl.content\"' +\n        '/>')($scope));\n      }\n      \n    }]\n  });\nangular.module('ngwig-app-templates', ['ng-wig/views/ng-wig.html']);\n\nangular.module(\"ng-wig/views/ng-wig.html\", []).run([\"$templateCache\", function($templateCache) {\n  $templateCache.put(\"ng-wig/views/ng-wig.html\",\n    \"<div class=\\\"ng-wig\\\">\\n\" +\n    \"\t<ul class=\\\"nw-toolbar\\\">\\n\" +\n    \"\t\t<li class=\\\"nw-toolbar__item\\\" ng-repeat=\\\"button in $ctrl.toolbarButtons\\\">\\n\" +\n    \"\t\t\t<div ng-if=\\\"!button.isComplex\\\">\\n\" +\n    \"\t\t\t\t<button type=\\\"button\\\" class=\\\"nw-button {{button.styleClass}}\\\" title=\\\"{{button.title}}\\\" ng-click=\\\"$ctrl.execCommand(button.command)\\\"\\n\" +\n    \"\t\t\t\t ng-class=\\\"{ 'nw-button--active': !$ctrl.disabled && $ctrl.isEditorActive() && button.isActive() }\\\" ng-disabled=\\\"$ctrl.editMode || $ctrl.disabled\\\">\\n\" +\n    \"\t\t\t\t\t{{ button.title }}\\n\" +\n    \"\t\t\t\t</button>\\n\" +\n    \"\t\t\t</div>\\n\" +\n    \"\t\t\t<div ng-if=\\\"button.isComplex\\\">\\n\" +\n    \"\t\t\t\t<ng-wig-plugin exec-command=\\\"$ctrl.execCommand\\\" plugin=\\\"button\\\" edit-mode=\\\"$ctrl.editMode\\\" disabled=\\\"$ctrl.disabled\\\" options=\\\"$ctrl.options\\\"\\n\" +\n    \"\t\t\t\t content=\\\"$ctrl.content\\\"></ng-wig-plugin>\\n\" +\n    \"\t\t\t</div>\\n\" +\n    \"\t\t</li>\\n\" +\n    \"\t\t<!--\\n\" +\n    \"    -->\\n\" +\n    \"\t\t<li class=\\\"nw-toolbar__item\\\">\\n\" +\n    \"\t\t\t<button type=\\\"button\\\" class=\\\"nw-button nw-button--source\\\" title=\\\"Edit HTML\\\" ng-class=\\\"{ 'nw-button--active': $ctrl.editMode }\\\"\\n\" +\n    \"\t\t\t ng-if=\\\"$ctrl.isSourceModeAllowed\\\" ng-click=\\\"$ctrl.toggleEditMode()\\\" ng-disabled=\\\"$ctrl.disabled\\\">\\n\" +\n    \"\t\t\t\tEdit HTML\\n\" +\n    \"\t\t\t</button>\\n\" +\n    \"\t\t</li>\\n\" +\n    \"\t</ul>\\n\" +\n    \"\\n\" +\n    \"\t<div class=\\\"nw-editor-container\\\">\\n\" +\n    \"\t\t<div class=\\\"nw-editor__src-container\\\" ng-show=\\\"$ctrl.editMode\\\">\\n\" +\n    \"\t\t\t<textarea ng-model=\\\"$ctrl.content\\\" ng-disabled=\\\"$ctrl.disabled\\\" id=\\\"nw-editor__src\\\" ng-keydown=\\\"$ctrl.keyDown($event)\\\"></textarea>\\n\" +\n    \"\t\t</div>\\n\" +\n    \"\t\t<div class=\\\"nw-editor\\\" ng-class=\\\"{ 'nw-disabled': $ctrl.disabled }\\\">\\n\" +\n    \"\t\t\t<div id=\\\"ng-wig-editable\\\" class=\\\"nw-editor__res\\\" ng-class=\\\"{'nw-invisible': $ctrl.editMode}\\\" ng-disabled=\\\"$ctrl.disabled\\\"\\n\" +\n    \"\t\t\t contenteditable placeholder=\\\"{{$ctrl.placeholder}}\\\">\\n\" +\n    \"\t\t\t</div>\\n\" +\n    \"\t\t</div>\\n\" +\n    \"\t</div>\\n\" +\n    \"</div>\");\n}]);\n"]}